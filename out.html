<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FuzzRPC Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 4px; }
    .high { background: #fdd; }
    .low { background: #dfd; }
  </style>
</head>
<body>
  <h1>FuzzRPC Findings</h1>

  <h2>Error Counts per Method</h2>
  <canvas id="errorChart" width="600" height="300"></canvas>

  <h2>All Findings</h2>
  <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Service</th>
        <th>Method</th>
        <th>Payload</th>
        <th>Error</th>
      </tr>
    </thead>
    <tbody>
      <tr class="low">
        <td>2025-05-19 13:35:04.6921679 &#43;0300 EEST m=&#43;0.026150901</td>
        <td>helloworld.Greeter</td>
        <td>SayHello</td>
        <td><pre>{&#34;name&#34;:&#34;A&#34;}</pre></td>
        <td></td>
      </tr>
      <tr class="low">
        <td>2025-05-19 13:35:04.6921679 &#43;0300 EEST m=&#43;0.026150901</td>
        <td>helloworld.Greeter</td>
        <td>SayHello</td>
        <td><pre>{&#34;name&#34;:&#34;GoQIK5MwOqbutFWjdAqHMuQmp7o9BC8lTs3RH46bJSRjD263k3xWjzKeMbcf3f7G&#34;}</pre></td>
        <td></td>
      </tr>
      <tr class="low">
        <td>2025-05-19 13:35:04.6928509 &#43;0300 EEST m=&#43;0.026833901</td>
        <td>helloworld.Greeter</td>
        <td>SayHello</td>
        <td><pre>{&#34;name&#34;:&#34;&#39; OR &#39;1&#39;=&#39;1&#34;}</pre></td>
        <td></td>
      </tr>
    </tbody>
  </table>

  <script>
    
    const findings = [{"service":"helloworld.Greeter","method":"SayHello","payload":"{\"name\":\"A\"}","error":"","timestamp":"2025-05-19T13:35:04.6921679+03:00"},{"service":"helloworld.Greeter","method":"SayHello","payload":"{\"name\":\"GoQIK5MwOqbutFWjdAqHMuQmp7o9BC8lTs3RH46bJSRjD263k3xWjzKeMbcf3f7G\"}","error":"","timestamp":"2025-05-19T13:35:04.6921679+03:00"},{"service":"helloworld.Greeter","method":"SayHello","payload":"{\"name\":\"' OR '1'='1\"}","error":"","timestamp":"2025-05-19T13:35:04.6928509+03:00"}];
    const counts = {};
    findings.forEach(f => {
      counts[f.method] = (counts[f.method] || 0) + (f.error ? 1 : 0);
    });
    new Chart(document.getElementById('errorChart'), {
      type: 'bar',
      data: {
        labels: Object.keys(counts),
        datasets: [{ label: 'Errors per Method', data: Object.values(counts) }]
      }
    });
  </script>
</body>
</html>
